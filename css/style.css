:root{
  --bg:#0b1020; --card:#131b34; --muted:#293356; --accent:#6ea8fe; --text:#e9eefc; --sub:#b9c3e6; --danger:#ff6b6b; --ok:#3ddc97;
}
[data-theme="light"]{
  --bg:#f6f7fb; --card:#ffffff; --muted:#e8ecf7; --accent:#3b82f6; --text:#0f172a; --sub:#374151; --danger:#dc2626; --ok:#059669;
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--text)}
.container{max-width:1100px;margin:24px auto;padding:16px}
.header{display:flex;gap:16px;align-items:center;justify-content:space-between;margin-bottom:16px}
.title{font-weight:800;letter-spacing:.4px}
.title small{display:block;font-weight:500;color:var(--sub)}
.row{display:flex;gap:16px;flex-wrap:wrap}
.card{background:var(--card);border:1px solid var(--muted);border-radius:16px;box-shadow:0 8px 24px rgba(0,0,0,.25);padding:12px}
.display{flex:1;min-width:280px}
.display .screen{display:flex;flex-direction:column;gap:8px;background:linear-gradient(180deg, rgba(255,255,255,.02), transparent);border-radius:12px;padding:16px;border:1px solid var(--muted)}
.screen .expr{min-height:24px;font-size:14px;color:var(--sub);text-align:right;word-break:break-all}
.screen .value{font-size:40px;font-weight:800;text-align:right}
.screen .memo{display:flex;gap:6px;flex-wrap:wrap}
.chip{font-size:12px;padding:4px 8px;border-radius:999px;background:var(--muted);color:var(--text);opacity:.9}

.controls{display:flex;gap:12px;align-items:center;flex-wrap:wrap;margin-top:8px}
.segmented{display:inline-flex;background:var(--muted);border-radius:12px;overflow:hidden}
.segmented button{all:unset;padding:8px 12px;cursor:pointer;color:var(--text);opacity:.8}
.segmented button.active{background:var(--accent);opacity:1}
.btn, .kbd{all:unset;display:inline-flex;align-items:center;justify-content:center;padding:10px 14px;border-radius:12px;background:var(--muted);cursor:pointer;font-weight:600}
.btn:hover{filter:brightness(1.1)}
.btn.ghost{background:transparent;border:1px dashed var(--muted)}
.switch{display:inline-flex;align-items:center;gap:8px}
.switch input{appearance:none;width:42px;height:24px;background:var(--muted);border-radius:999px;position:relative;outline:none;cursor:pointer}
.switch input:checked{background:var(--accent)}
.switch input:before{content:"";position:absolute;width:18px;height:18px;left:3px;top:3px;border-radius:50%;background:#fff;transition:left .2s}
.switch input:checked:before{left:21px}

.pad{display:grid;grid-template-columns:repeat(4,1fr);gap:10px}
.key{user-select:none;display:flex;align-items:center;justify-content:center;padding:14px;border-radius:12px;background:var(--muted);font-size:18px;font-weight:700;cursor:pointer}
.key.op{background:rgba(110,168,254,.2);border:1px solid var(--accent)}
.key.eq{background:var(--accent);color:#071020}
.key.danger{background:rgba(255,107,107,.15);border:1px solid var(--danger)}
.sp2{grid-column:span 2}

.tabs{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:8px}
.tabs button{all:unset;padding:8px 12px;border-radius:10px;background:var(--muted);cursor:pointer}
.tabs button.active{background:var(--accent);color:#071020;font-weight:800}

.panel{display:none}
.panel.active{display:block}

.history{max-height:360px;overflow:auto}
.history .item{display:flex;justify-content:space-between;gap:12px;padding:8px;border-bottom:1px dashed var(--muted)}
.history .item .lhs{color:var(--sub);font-size:12px}
.history .item .rhs{font-weight:800}

.section{padding:8px;border:1px solid var(--muted);border-radius:12px;margin-bottom:12px}
.section h4{margin:.2rem 0 .6rem 0}
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:8px}
.grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
.input, select{width:100%;padding:10px;border-radius:10px;border:1px solid var(--muted);background:transparent;color:var(--text)}
.hint{font-size:12px;color:var(--sub)}
.ok{color:var(--ok)}
.danger{color:var(--danger)}
.small{font-size:12px}
.mono{font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace}